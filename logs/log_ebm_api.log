2026-02-05 21:45:39,941 - ebm.main - INFO - Loading EBM model from models/ebm_hardneg.pt
2026-02-05 21:45:39,941 - ebm.main - INFO - Using device: cuda
2026-02-05 21:45:42,685 - httpx - INFO - HTTP Request: HEAD https://huggingface.co/sentence-transformers/msmarco-MiniLM-L6-v3/resolve/main/config.json "HTTP/1.1 307 Temporary Redirect"
2026-02-05 21:45:42,717 - httpx - INFO - HTTP Request: HEAD https://huggingface.co/api/resolve-cache/models/sentence-transformers/msmarco-MiniLM-L6-v3/fea93b3df3924e5649a4e322c345f951239d2c13/config.json "HTTP/1.1 200 OK"
2026-02-05 21:45:42,998 - httpx - INFO - HTTP Request: HEAD https://huggingface.co/sentence-transformers/msmarco-MiniLM-L6-v3/resolve/main/tokenizer_config.json "HTTP/1.1 307 Temporary Redirect"
2026-02-05 21:45:43,032 - httpx - INFO - HTTP Request: HEAD https://huggingface.co/api/resolve-cache/models/sentence-transformers/msmarco-MiniLM-L6-v3/fea93b3df3924e5649a4e322c345f951239d2c13/tokenizer_config.json "HTTP/1.1 200 OK"
2026-02-05 21:45:43,313 - httpx - INFO - HTTP Request: GET https://huggingface.co/api/models/sentence-transformers/msmarco-MiniLM-L6-v3/tree/main/additional_chat_templates?recursive=false&expand=false "HTTP/1.1 404 Not Found"
2026-02-05 21:45:43,602 - httpx - INFO - HTTP Request: GET https://huggingface.co/api/models/sentence-transformers/msmarco-MiniLM-L6-v3/tree/main?recursive=true&expand=false "HTTP/1.1 200 OK"
2026-02-05 21:45:44,024 - httpx - INFO - HTTP Request: HEAD https://huggingface.co/sentence-transformers/msmarco-MiniLM-L6-v3/resolve/main/config.json "HTTP/1.1 307 Temporary Redirect"
2026-02-05 21:45:44,057 - httpx - INFO - HTTP Request: HEAD https://huggingface.co/api/resolve-cache/models/sentence-transformers/msmarco-MiniLM-L6-v3/fea93b3df3924e5649a4e322c345f951239d2c13/config.json "HTTP/1.1 200 OK"
2026-02-05 21:45:44,347 - ebm.main - INFO -  Model loaded successfully
2026-02-05 21:45:44,364 - ebm.main - INFO - ================================================================================
2026-02-05 21:45:44,364 - ebm.main - INFO -  EBM Reranker API Started
2026-02-05 21:45:44,364 - ebm.main - INFO - ================================================================================
2026-02-05 21:45:44,364 - ebm.main - INFO - Model: sentence-transformers/msmarco-MiniLM-L6-v3
2026-02-05 21:45:44,364 - ebm.main - INFO - Weights: models/ebm_hardneg.pt
2026-02-05 21:45:44,365 - ebm.main - INFO - Device: cuda
2026-02-05 21:45:44,365 - ebm.main - INFO - Endpoints:
2026-02-05 21:45:44,365 - ebm.main - INFO -   - POST /v1/rerank
2026-02-05 21:45:44,365 - ebm.main - INFO -   - GET /health
2026-02-05 21:45:44,365 - ebm.main - INFO -   - GET /docs
2026-02-05 21:45:44,365 - ebm.main - INFO - ================================================================================
2026-02-05 23:29:02,877 - ebm.main - INFO - Loading EBM model from models/ebm_hardneg.pt
2026-02-05 23:29:02,877 - ebm.main - INFO - Using device: cuda
2026-02-05 23:29:08,672 - httpx - INFO - HTTP Request: HEAD https://huggingface.co/sentence-transformers/msmarco-MiniLM-L6-v3/resolve/main/config.json "HTTP/1.1 307 Temporary Redirect"
2026-02-05 23:29:08,731 - httpx - INFO - HTTP Request: HEAD https://huggingface.co/api/resolve-cache/models/sentence-transformers/msmarco-MiniLM-L6-v3/fea93b3df3924e5649a4e322c345f951239d2c13/config.json "HTTP/1.1 200 OK"
2026-02-05 23:29:09,024 - httpx - INFO - HTTP Request: HEAD https://huggingface.co/sentence-transformers/msmarco-MiniLM-L6-v3/resolve/main/tokenizer_config.json "HTTP/1.1 307 Temporary Redirect"
2026-02-05 23:29:09,084 - httpx - INFO - HTTP Request: HEAD https://huggingface.co/api/resolve-cache/models/sentence-transformers/msmarco-MiniLM-L6-v3/fea93b3df3924e5649a4e322c345f951239d2c13/tokenizer_config.json "HTTP/1.1 200 OK"
2026-02-05 23:29:09,377 - httpx - INFO - HTTP Request: GET https://huggingface.co/api/models/sentence-transformers/msmarco-MiniLM-L6-v3/tree/main/additional_chat_templates?recursive=false&expand=false "HTTP/1.1 404 Not Found"
2026-02-05 23:29:09,674 - httpx - INFO - HTTP Request: GET https://huggingface.co/api/models/sentence-transformers/msmarco-MiniLM-L6-v3/tree/main?recursive=true&expand=false "HTTP/1.1 200 OK"
2026-02-05 23:29:10,122 - httpx - INFO - HTTP Request: HEAD https://huggingface.co/sentence-transformers/msmarco-MiniLM-L6-v3/resolve/main/config.json "HTTP/1.1 307 Temporary Redirect"
2026-02-05 23:29:10,185 - httpx - INFO - HTTP Request: HEAD https://huggingface.co/api/resolve-cache/models/sentence-transformers/msmarco-MiniLM-L6-v3/fea93b3df3924e5649a4e322c345f951239d2c13/config.json "HTTP/1.1 200 OK"
2026-02-05 23:29:10,800 - ebm.main - INFO - Model loaded successfully
2026-02-05 23:29:10,840 - ebm.main - INFO - ================================================================================
2026-02-05 23:29:10,840 - ebm.main - INFO -   EBM Reranker API Started
2026-02-05 23:29:10,840 - ebm.main - INFO - ================================================================================
2026-02-05 23:29:10,840 - ebm.main - INFO - Model: sentence-transformers/msmarco-MiniLM-L6-v3
2026-02-05 23:29:10,840 - ebm.main - INFO - Weights: models/ebm_hardneg.pt
2026-02-05 23:29:10,840 - ebm.main - INFO - Device: cuda
2026-02-05 23:29:10,840 - ebm.main - INFO - Endpoints:
2026-02-05 23:29:10,840 - ebm.main - INFO -   - POST /v1/rerank
2026-02-05 23:29:10,840 - ebm.main - INFO -   - GET /health
2026-02-05 23:29:10,840 - ebm.main - INFO -   - GET /docs
2026-02-05 23:29:10,840 - ebm.main - INFO - ================================================================================
2026-02-05 23:30:48,089 - ebm.main - INFO - >>> Incoming: GET /health from 127.0.0.1
2026-02-05 23:30:48,090 - ebm.main - INFO - <<< Response: 200
2026-02-05 23:30:50,093 - ebm.main - INFO - >>> Incoming: GET /health from 127.0.0.1
2026-02-05 23:30:50,093 - ebm.main - INFO - <<< Response: 200
2026-02-05 23:30:52,096 - ebm.main - INFO - >>> Incoming: GET /health from 127.0.0.1
2026-02-05 23:30:52,096 - ebm.main - INFO - <<< Response: 200
2026-02-05 23:31:11,737 - ebm.main - INFO - >>> Incoming: POST /v1/rerank from 127.0.0.1
2026-02-05 23:31:11,739 - ebm.main - INFO - ================================================================================
2026-02-05 23:31:11,739 - ebm.main - INFO -  RERANK REQUEST at 2026-02-05 23:31:11.739220
2026-02-05 23:31:11,739 - ebm.main - INFO -    Query: What is deep learning ?
2026-02-05 23:31:11,739 - ebm.main - INFO -    Documents: 64
2026-02-05 23:31:11,739 - ebm.main - INFO -    Top N requested: 64
2026-02-05 23:32:24,102 - ebm.main - INFO -    Processed 4 batches of size 16
2026-02-05 23:32:24,102 - ebm.main - INFO -    Energy range: [4.4863, 5.9688]
2026-02-05 23:32:24,102 - ebm.main - INFO -    Score range: [0.0000, 1.0000]
2026-02-05 23:32:24,102 - ebm.main - INFO -    Top 5 results:
2026-02-05 23:32:24,102 - ebm.main - INFO -       1. [idx=59] score=1.0000: the goal of train deep learn architectur is optim of the wei...
2026-02-05 23:32:24,102 - ebm.main - INFO -       2. [idx=5] score=0.9484: tensorlay a versatil librari for effici deep learn develop h...
2026-02-05 23:32:24,102 - ebm.main - INFO -       3. [idx=39] score=0.8889: our goal is to use spars code and to find high level represe...
2026-02-05 23:32:24,102 - ebm.main - INFO -       4. [idx=52] score=0.8361: and deep learn method featur b and complet set of featur c u...
2026-02-05 23:32:24,103 - ebm.main - INFO -       5. [idx=28] score=0.7808: geometri of optim and implicit regular in deep learn this su...
2026-02-05 23:32:24,103 - ebm.main - INFO -  Reranking completed in 72.364s
2026-02-05 23:32:24,103 - ebm.main - INFO -    Returning 64 results
2026-02-05 23:32:24,103 - ebm.main - INFO -    Request ID: fe12efaa-3aef-4924-8dc8-5230668b4362
2026-02-05 23:32:24,103 - ebm.main - INFO - ================================================================================
2026-02-05 23:32:24,112 - ebm.main - INFO - <<< Response: 200
2026-02-05 23:37:31,874 - ebm.main - INFO - Loading EBM model from models/ebm_hardneg.pt
2026-02-05 23:37:31,874 - ebm.main - INFO - Using device: cuda
2026-02-05 23:37:37,507 - httpx - INFO - HTTP Request: HEAD https://huggingface.co/sentence-transformers/msmarco-MiniLM-L6-v3/resolve/main/config.json "HTTP/1.1 307 Temporary Redirect"
2026-02-05 23:37:37,571 - httpx - INFO - HTTP Request: HEAD https://huggingface.co/api/resolve-cache/models/sentence-transformers/msmarco-MiniLM-L6-v3/fea93b3df3924e5649a4e322c345f951239d2c13/config.json "HTTP/1.1 200 OK"
2026-02-05 23:37:38,032 - httpx - INFO - HTTP Request: HEAD https://huggingface.co/sentence-transformers/msmarco-MiniLM-L6-v3/resolve/main/tokenizer_config.json "HTTP/1.1 307 Temporary Redirect"
2026-02-05 23:37:38,153 - httpx - INFO - HTTP Request: HEAD https://huggingface.co/api/resolve-cache/models/sentence-transformers/msmarco-MiniLM-L6-v3/fea93b3df3924e5649a4e322c345f951239d2c13/tokenizer_config.json "HTTP/1.1 200 OK"
2026-02-05 23:37:38,542 - httpx - INFO - HTTP Request: GET https://huggingface.co/api/models/sentence-transformers/msmarco-MiniLM-L6-v3/tree/main/additional_chat_templates?recursive=false&expand=false "HTTP/1.1 404 Not Found"
2026-02-05 23:37:38,852 - httpx - INFO - HTTP Request: GET https://huggingface.co/api/models/sentence-transformers/msmarco-MiniLM-L6-v3/tree/main?recursive=true&expand=false "HTTP/1.1 200 OK"
2026-02-05 23:37:39,205 - httpx - INFO - HTTP Request: HEAD https://huggingface.co/sentence-transformers/msmarco-MiniLM-L6-v3/resolve/main/config.json "HTTP/1.1 307 Temporary Redirect"
2026-02-05 23:37:39,205 - huggingface_hub.utils._http - WARNING - Warning: You are sending unauthenticated requests to the HF Hub. Please set a HF_TOKEN to enable higher rate limits and faster downloads.
2026-02-05 23:37:39,263 - httpx - INFO - HTTP Request: HEAD https://huggingface.co/api/resolve-cache/models/sentence-transformers/msmarco-MiniLM-L6-v3/fea93b3df3924e5649a4e322c345f951239d2c13/config.json "HTTP/1.1 200 OK"
2026-02-05 23:37:39,972 - ebm.main - INFO - Model loaded successfully
2026-02-05 23:37:40,006 - ebm.main - INFO - ================================================================================
2026-02-05 23:37:40,006 - ebm.main - INFO -   EBM Reranker API Started
2026-02-05 23:37:40,006 - ebm.main - INFO - ================================================================================
2026-02-05 23:37:40,006 - ebm.main - INFO - Model: sentence-transformers/msmarco-MiniLM-L6-v3
2026-02-05 23:37:40,006 - ebm.main - INFO - Weights: models/ebm_hardneg.pt
2026-02-05 23:37:40,006 - ebm.main - INFO - Device: cuda
2026-02-05 23:37:40,006 - ebm.main - INFO - Endpoints:
2026-02-05 23:37:40,006 - ebm.main - INFO -   - POST /v1/rerank
2026-02-05 23:37:40,006 - ebm.main - INFO -   - GET /health
2026-02-05 23:37:40,006 - ebm.main - INFO -   - GET /docs
2026-02-05 23:37:40,006 - ebm.main - INFO - ================================================================================
2026-02-05 23:38:33,248 - ebm.main - INFO - >>> Incoming: POST /v1/rerank from 127.0.0.1
2026-02-05 23:38:33,251 - ebm.main - INFO - ================================================================================
2026-02-05 23:38:33,251 - ebm.main - INFO -  RERANK REQUEST at 2026-02-05 23:38:33.251127
2026-02-05 23:38:33,251 - ebm.main - INFO -    Query: what is deep learning ?
2026-02-05 23:38:33,251 - ebm.main - INFO -    Documents: 64
2026-02-05 23:38:33,251 - ebm.main - INFO -    Top N requested: 64
2026-02-05 23:39:09,532 - ebm.main - INFO -    Processed 8 batches of size 8
2026-02-05 23:39:09,532 - ebm.main - INFO -    Energy range: [4.4863, 5.9688]
2026-02-05 23:39:09,532 - ebm.main - INFO -    Score range: [0.0000, 1.0000]
2026-02-05 23:39:09,532 - ebm.main - INFO -    Top 5 results:
2026-02-05 23:39:09,532 - ebm.main - INFO -       1. [idx=55] score=1.0000: the goal of train deep learn architectur is optim of the wei...
2026-02-05 23:39:09,532 - ebm.main - INFO -       2. [idx=5] score=0.9484: tensorlay a versatil librari for effici deep learn develop h...
2026-02-05 23:39:09,532 - ebm.main - INFO -       3. [idx=38] score=0.8889: our goal is to use spars code and to find high level represe...
2026-02-05 23:39:09,532 - ebm.main - INFO -       4. [idx=49] score=0.8361: and deep learn method featur b and complet set of featur c u...
2026-02-05 23:39:09,532 - ebm.main - INFO -       5. [idx=31] score=0.7808: geometri of optim and implicit regular in deep learn this su...
2026-02-05 23:39:09,532 - ebm.main - INFO -  Reranking completed in 36.282s
2026-02-05 23:39:09,532 - ebm.main - INFO -    Returning 64 results
2026-02-05 23:39:09,532 - ebm.main - INFO -    Request ID: 78f4d17f-b16d-4662-9ce7-11513115f683
2026-02-05 23:39:09,532 - ebm.main - INFO - ================================================================================
2026-02-05 23:39:09,534 - ebm.main - INFO - <<< Response: 200
2026-02-05 23:41:57,503 - ebm.main - INFO - >>> Incoming: POST /v1/rerank from 127.0.0.1
2026-02-05 23:41:57,506 - ebm.main - INFO - ================================================================================
2026-02-05 23:41:57,506 - ebm.main - INFO -  RERANK REQUEST at 2026-02-05 23:41:57.506336
2026-02-05 23:41:57,506 - ebm.main - INFO -    Query: Is this helpful?
2026-02-05 23:41:57,506 - ebm.main - INFO -    Documents: 64
2026-02-05 23:41:57,506 - ebm.main - INFO -    Top N requested: 64
2026-02-05 23:42:33,322 - ebm.main - INFO -    Processed 8 batches of size 8
2026-02-05 23:42:33,322 - ebm.main - INFO -    Energy range: [4.7275, 6.6381]
2026-02-05 23:42:33,322 - ebm.main - INFO -    Score range: [0.0000, 1.0000]
2026-02-05 23:42:33,323 - ebm.main - INFO -    Top 5 results:
2026-02-05 23:42:33,323 - ebm.main - INFO -       1. [idx=21] score=1.0000: our goal is to use spars code and to find high level represe...
2026-02-05 23:42:33,323 - ebm.main - INFO -       2. [idx=18] score=0.8293: introduct to asymmetr inform inform asymmetri is a studi of ...
2026-02-05 23:42:33,323 - ebm.main - INFO -       3. [idx=51] score=0.7963: where x is the i th sampl it is clear shown that ae can be r...
2026-02-05 23:42:33,323 - ebm.main - INFO -       4. [idx=14] score=0.7473: the human to be reward independ of whether it help figur 73 ...
2026-02-05 23:42:33,323 - ebm.main - INFO -       5. [idx=13] score=0.7004: other form of personalis could be valuabl for instanc use in...
2026-02-05 23:42:33,323 - ebm.main - INFO -  Reranking completed in 35.817s
2026-02-05 23:42:33,323 - ebm.main - INFO -    Returning 64 results
2026-02-05 23:42:33,323 - ebm.main - INFO -    Request ID: 1f83215e-9bf7-49b2-a8df-48d48ad0ed50
2026-02-05 23:42:33,323 - ebm.main - INFO - ================================================================================
2026-02-05 23:42:33,324 - ebm.main - INFO - <<< Response: 200
2026-02-05 23:43:49,128 - ebm.main - INFO - >>> Incoming: POST /v1/rerank from 127.0.0.1
2026-02-05 23:43:49,134 - ebm.main - INFO - ================================================================================
2026-02-05 23:43:49,134 - ebm.main - INFO -  RERANK REQUEST at 2026-02-05 23:43:49.134517
2026-02-05 23:43:49,134 - ebm.main - INFO -    Query: Are there any formulas related to deep learning?
2026-02-05 23:43:49,134 - ebm.main - INFO -    Documents: 64
2026-02-05 23:43:49,134 - ebm.main - INFO -    Top N requested: 64
2026-02-05 23:44:25,128 - ebm.main - INFO -    Processed 8 batches of size 8
2026-02-05 23:44:25,128 - ebm.main - INFO -    Energy range: [4.6185, 6.5093]
2026-02-05 23:44:25,128 - ebm.main - INFO -    Score range: [0.0000, 1.0000]
2026-02-05 23:44:25,129 - ebm.main - INFO -    Top 5 results:
2026-02-05 23:44:25,129 - ebm.main - INFO -       1. [idx=38] score=1.0000: the goal of train deep learn architectur is optim of the wei...
2026-02-05 23:44:25,129 - ebm.main - INFO -       2. [idx=44] score=0.9123: our goal is to use spars code and to find high level represe...
2026-02-05 23:44:25,129 - ebm.main - INFO -       3. [idx=3] score=0.8876: tensorlay a versatil librari for effici deep learn develop h...
2026-02-05 23:44:25,129 - ebm.main - INFO -       4. [idx=10] score=0.7370: acceler deep learn a more deep learn model paramet and train...
2026-02-05 23:44:25,129 - ebm.main - INFO -       5. [idx=2] score=0.7282: geometri of optim and implicit regular in deep learn this su...
2026-02-05 23:44:25,129 - ebm.main - INFO -  Reranking completed in 35.995s
2026-02-05 23:44:25,133 - ebm.main - INFO -    Returning 64 results
2026-02-05 23:44:25,133 - ebm.main - INFO -    Request ID: 1dc90232-dbe6-4f66-89d9-4ec9409139a5
2026-02-05 23:44:25,133 - ebm.main - INFO - ================================================================================
2026-02-05 23:44:25,134 - ebm.main - INFO - <<< Response: 200
2026-02-05 23:47:08,220 - ebm.main - INFO - >>> Incoming: POST /v1/rerank from 127.0.0.1
2026-02-05 23:47:08,220 - ebm.main - INFO - ================================================================================
2026-02-05 23:47:08,221 - ebm.main - INFO -  RERANK REQUEST at 2026-02-05 23:47:08.220925
2026-02-05 23:47:08,221 - ebm.main - INFO -    Query: Explain the Forward Propagation formula.
2026-02-05 23:47:08,221 - ebm.main - INFO -    Documents: 64
2026-02-05 23:47:08,221 - ebm.main - INFO -    Top N requested: 64
2026-02-05 23:47:44,709 - ebm.main - INFO -    Processed 8 batches of size 8
2026-02-05 23:47:44,709 - ebm.main - INFO -    Energy range: [4.3303, 5.9531]
2026-02-05 23:47:44,709 - ebm.main - INFO -    Score range: [0.0000, 1.0000]
2026-02-05 23:47:44,709 - ebm.main - INFO -    Top 5 results:
2026-02-05 23:47:44,709 - ebm.main - INFO -       1. [idx=15] score=1.0000: the goal of train deep learn architectur is optim of the wei...
2026-02-05 23:47:44,709 - ebm.main - INFO -       2. [idx=32] score=0.9212: our goal is to use spars code and to find high level represe...
2026-02-05 23:47:44,709 - ebm.main - INFO -       3. [idx=9] score=0.8278: read what is nine plus twelv to see if the system can identi...
2026-02-05 23:47:44,709 - ebm.main - INFO -       4. [idx=3] score=0.8022: 27 2 from the deep render model to deep convolut network we ...
2026-02-05 23:47:44,709 - ebm.main - INFO -       5. [idx=39] score=0.6822: geometri of optim and implicit regular in deep learn this su...
2026-02-05 23:47:44,709 - ebm.main - INFO -  Reranking completed in 36.489s
2026-02-05 23:47:44,709 - ebm.main - INFO -    Returning 64 results
2026-02-05 23:47:44,709 - ebm.main - INFO -    Request ID: 486ad235-7bfa-4ae2-91dc-7864aec1c553
2026-02-05 23:47:44,709 - ebm.main - INFO - ================================================================================
2026-02-05 23:47:44,711 - ebm.main - INFO - <<< Response: 200
